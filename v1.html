<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flux de Parsing Minishell</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .title {
            text-align: center;
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .phase {
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .phase::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            background: var(--phase-bg);
            z-index: 1;
        }
        
        .phase > * {
            position: relative;
            z-index: 2;
        }
        
        .phase-1 { 
            --phase-bg: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-left: 5px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        .phase-2 { 
            --phase-bg: linear-gradient(135deg, #4ecdc4, #44a08d);
            border-left: 5px solid #4ecdc4;
            background: rgba(78, 205, 196, 0.05);
        }
        .phase-3 { 
            --phase-bg: linear-gradient(135deg, #45b7d1, #96c93d);
            border-left: 5px solid #45b7d1;
            background: rgba(69, 183, 209, 0.05);
        }
        .phase-4 { 
            --phase-bg: linear-gradient(135deg, #f093fb, #f5576c);
            border-left: 5px solid #f093fb;
            background: rgba(240, 147, 251, 0.05);
        }
        
        .phase-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .step {
            background: white;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .step:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .step-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .step-desc {
            color: #555;
            line-height: 1.6;
        }
        
        .code {
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            font-weight: bold;
        }
        
        .arrow {
            text-align: center;
            font-size: 2em;
            color: #7f8c8d;
            margin: 15px 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .example {
            background: rgba(52, 152, 219, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #3498db;
        }
        
        .example-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .tokens {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .token {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(52, 152, 219, 0.3);
        }
        
        .ast-tree {
            font-family: 'Courier New', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            white-space: pre;
            line-height: 1.6;
        }
        
        .files-section {
            background: rgba(149, 165, 166, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .files-title {
            font-size: 1.5em;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .file-group {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .file-group-title {
            font-weight: bold;
            color: #8e44ad;
            margin-bottom: 8px;
        }
        
        .file-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .file {
            background: #9b59b6;
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üîç Flux de Parsing du Minishell</h1>
        
        <div class="example">
            <div class="example-title">üìù Exemple d'entr√©e :</div>
            <code>echo "$USER world" | grep hello > output.txt && cat file</code>
        </div>
        
        <div class="phase phase-1">
            <div class="phase-title">üî§ PHASE 1 : ANALYSE LEXICALE (Lexer)</div>
            
            <div class="step">
                <div class="step-title">1. Initialisation et boucle principale</div>
                <div class="step-desc">
                    <span class="code">lexer(char *input)</span> : Cr√©e une liste cha√Æn√©e de tokens vide, puis it√®re sur chaque caract√®re.
                    <strong>Algorithme :</strong> Tant qu'il y a des caract√®res ‚Üí ignorer espaces ‚Üí traiter token ‚Üí avancer position.
                    La fonction retourne NULL en cas d'erreur de m√©moire.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Gestion des espaces blancs</div>
                <div class="step-desc">
                    <span class="code">skip_whitespace(input, i)</span> : Avance l'index tant que le caract√®re est un espace ou une tabulation.
                    <strong>Important :</strong> Ne traite pas les retours √† la ligne (assum√©s g√©r√©s en amont).
                    Retourne le nouvel index apr√®s les espaces.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Classification des caract√®res</div>
                <div class="step-desc">
                    <span class="code">is_operator(c)</span> : Teste si c = {|, <, >, &}.
                    <span class="code">process_token()</span> route vers <span class="code">extract_operator()</span> ou <span class="code">extract_word_with_quotes()</span>.
                    Chaque token est cr√©√© avec <span class="code">create_token(type, value)</span>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-2">
            <div class="phase-title">üîÑ PHASE 2 : EXPANSION (Expander)</div>
            
            <div class="step">
                <div class="step-title">1. Point d'entr√©e et filtrage</div>
                <div class="step-desc">
                    <span class="code">expand_tokens(tokens, shell)</span> : Parcourt la liste cha√Æn√©e.
                    <strong>Filtrage :</strong> Seuls les TOKEN_WORD sont trait√©s. Les op√©rateurs restent inchang√©s.
                    <strong>S√©curit√© :</strong> Sauvegarde next avant traitement car la liste peut √™tre modifi√©e.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Segmentation avanc√©e des tokens</div>
                <div class="step-desc">
                    <span class="code">expand_token_segments(str, shell)</span> : 
                    <strong>Algorithme :</strong> Parcourt caract√®re par caract√®re ‚Üí Identifie segments quot√©s/non-quot√©s ‚Üí Traite chaque segment selon son contexte.
                    <strong>√âtats :</strong> guillemet_simple | guillemet_double | hors_guillemets.
                    Reconstruction finale par concat√©nation des segments trait√©s.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Expansion contextuelle des variables</div>
                <div class="step-desc">
                    <strong>Guillemets simples :</strong> <span class="code">handle_single_quote()</span> ‚Üí Aucune expansion, copie litt√©rale.
                    <strong>Guillemets doubles :</strong> <span class="code">handle_double_quote()</span> ‚Üí <span class="code">expand_in_double_quotes()</span> ‚Üí Expansion des $ autoris√©e.
                    <strong>Hors guillemets :</strong> <span class="code">expand_outside_quotes()</span> ‚Üí Expansion compl√®te + s√©paration possible.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">4. Types de variables et expansion</div>
                <div class="step-desc">
                    <span class="code">expand_variable(str, &i, shell)</span> dispatche vers :
                    <strong>Sp√©ciales :</strong> $? (exit_status), $ (pid), $ isol√© (litt√©ral).
                    <strong>Num√©riques :</strong> $0, $1... ‚Üí <span class="code">handle_numeric_var()</span> ‚Üí Construction "$digit...".
                    <strong>Environnement :</strong> $VAR ‚Üí <span class="code">process_regular_var()</span> ‚Üí <span class="code">get_env_value()</span>.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">5. Algorithme de d√©tection des noms de variables</div>
                <div class="step-desc">
                    <strong>Validation :</strong> Premier caract√®re ‚àà {lettre, _, chiffre}, sinon $ litt√©ral.
                    <strong>Extraction :</strong> Tant que caract√®re ‚àà {alphanum, _} ‚Üí √©tendre le nom.
                    <span class="code">extract_var_key(str, start, &end)</span> : Retourne substring du nom.
                    <strong>R√©solution :</strong> <span class="code">get_var_value()</span> ‚Üí recherche dans l'environnement.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">6. S√©paration conditionnelle des tokens</div>
                <div class="step-desc">
                    <span class="code">should_split_token(original, expanded)</span> : 
                    <strong>Condition 1 :</strong> Token original sans guillemets externes (d√©tect√© par <span class="code">has_quotes()</span>).
                    <strong>Condition 2 :</strong> Expansion contient des espaces/tabs/newlines (<span class="code">has_whitespace()</span>).
                    <strong>Action :</strong> <span class="code">split_expanded_token()</span> ‚Üí <span class="code">ft_split()</span> + cr√©ation de nouveaux tokens.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">7. Normalisation et nettoyage</div>
                <div class="step-desc">
                    <span class="code">normalize_whitespace(expanded)</span> : Convertit \t et \n en espaces simples.
                    <span class="code">remove_quotes()</span> apr√®s expansion : Supprime guillemets externes en pr√©servant le contenu.
                    <span class="code">join_and_free(s1, s2)</span> : Concat√®ne + lib√®re automatiquement les cha√Ænes sources.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">Exemple d√©taill√© d'expansion (si $USER = "john doe") :</div>
                <p><strong>Token original :</strong> <code>"$USER world"</code></p>
                <p><strong>Segmentation :</strong> [guillemets_doubles: "$USER world"]</p>
                <p><strong>Expansion dans guillemets :</strong> "$USER" ‚Üí "john doe", "world" ‚Üí "world"</p>
                <p><strong>R√©sultat :</strong> "john doe world"</p>
                <p><strong>Suppression guillemets :</strong> john doe world</p>
                <p><strong>S√©paration :</strong> Pas de split car token √©tait entre guillemets</p>
                <div class="tokens">
                    <span class="token">TOKEN_WORD: echo</span>
                    <span class="token">TOKEN_WORD: john doe world</span>
                    <span class="token">TOKEN_PIPE: |</span>
                    <span class="token">TOKEN_WORD: grep</span>
                    <span class="token">TOKEN_WORD: hello</span>
                    <span class="token">TOKEN_REDIR_OUT: ></span>
                    <span class="token">TOKEN_WORD: output.txt</span>
                    <span class="token">TOKEN_AND: &&</span>
                    <span class="token">TOKEN_WORD: cat</span>
                    <span class="token">TOKEN_WORD: file</span>
                </div>
            </div>
        </div>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-3">
            <div class="phase-title">üå≥ PHASE 3 : ANALYSE SYNTAXIQUE (Parser)</div>
            
            <div class="step">
                <div class="step-title">1. Architecture Recursive Descent</div>
                <div class="step-desc">
                    <strong>Grammaire :</strong> Expression ‚Üí AndOr ‚Üí Pipeline ‚Üí Command.
                    <span class="code">parse(tokens)</span> ‚Üí <span class="code">parse_and_or(tokens)</span> (point d'entr√©e).
                    <strong>Priorit√© des op√©rateurs :</strong> && et || < | < commandes simples.
                    Chaque niveau appelle le niveau inf√©rieur, cr√©ant une hi√©rarchie naturelle.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Parsing des expressions AND/OR</div>
                <div class="step-desc">
                    <span class="code">parse_and_or(tokens)</span> :
                    <strong>Algorithme :</strong> Parse pipeline_gauche ‚Üí Si (&&||\||) ‚Üí Parse and_or_droite ‚Üí Cr√©e n≈ìud.
                    <strong>Associativit√© gauche :</strong> A && B && C devient (A && B) && C par r√©cursion droite.
                    <strong>Priorit√© √©gale :</strong> && et || ont m√™me priorit√©, √©valuation de gauche √† droite.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Parsing des pipelines</div>
                <div class="step-desc">
                    <span class="code">parse_pipeline(tokens)</span> :
                    <strong>Structure :</strong> command_gauche | pipeline_droite (r√©cursion droite pour associativit√© gauche).
                    <strong>Cr√©ation AST :</strong> <span class="code">create_pipeline_node(left, right)</span> ‚Üí n≈ìud AST_PIPELINE.
                    <strong>Gestion erreurs :</strong> Si √©chec parsing droite ‚Üí lib√®re gauche + retourne NULL.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">4. Parsing des commandes simples</div>
                <div class="step-desc">
                    <span class="code">parse_simple_command(tokens)</span> :
                    <strong>√âtape 1 :</strong> <span class="code">parse_redirections()</span> ‚Üí Parcourt et extrait toutes les redirections.
                    <strong>√âtape 2 :</strong> Reset √† start ‚Üí <span class="code">gather_all_words()</span> ‚Üí Collecte tous les TOKEN_WORD.
                    <strong>Cas sp√©cial :</strong> Si seulement redirections ‚Üí cr√©e argv vide avec <span class="code">create_empty_argv()</span>.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">5. Analyse des redirections</div>
                <div class="step-desc">
                    <span class="code">parse_redirections(tokens, node)</span> :
                    <strong>Reconnaissance :</strong> Identifie TOKEN_REDIR_* ‚Üí <span class="code">parse_redir()</span>.
                    <strong>Validation :</strong> Op√©rateur suivi d'un TOKEN_WORD obligatoire (nom de fichier).
                    <strong>Nettoyage :</strong> <span class="code">remove_quotes()</span> sur le nom de fichier.
                    <strong>Stockage :</strong> <span class="code">add_redir(&node->redirs, redir)</span> ‚Üí Liste cha√Æn√©e.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">6. Collecte et nettoyage des arguments</div>
                <div class="step-desc">
                    <span class="code">gather_all_words(tokens)</span> :
                    <strong>Comptage :</strong> <span class="code">count_word_tokens()</span> ‚Üí Parcourt jusqu'au prochain op√©rateur.
                    <strong>Allocation :</strong> <span class="code">allocate_argv(count + 1)</span> ‚Üí Tableau avec terminateur NULL.
                    <strong>Remplissage :</strong> <span class="code">fill_argv()</span> ‚Üí Copie + <span class="code">remove_quotes()</span> sur chaque mot.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">7. Construction de l'AST</div>
                <div class="step-desc">
                    <strong>Types de n≈ìuds :</strong> AST_COMMAND, AST_PIPELINE, AST_AND, AST_OR.
                    <span class="code">new_ast_node(type)</span> : Allocation + initialisation √† z√©ro + d√©finition du type.
                    <strong>Structure :</strong> type + argv + left/right + redirs.
                    <strong>Lib√©ration :</strong> <span class="code">free_ast()</span> r√©cursive sur left/right + lib√©ration argv/redirs.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">Construction de l'AST √©tape par √©tape :</div>
                <p><strong>Input :</strong> <code>echo hello | grep h > out && cat file</code></p>
                
                <div style="margin: 15px 0; font-family: monospace; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <strong>1. parse_and_or() d√©tecte &&</strong><br/>
                    Left: parse_pipeline() sur "echo hello | grep h > out"<br/>
                    Right: parse_and_or() sur "cat file"<br/><br/>
                    
                    <strong>2. parse_pipeline() d√©tecte |</strong><br/>
                    Left: parse_command() sur "echo hello"<br/>
                    Right: parse_pipeline() sur "grep h > out"<br/><br/>
                    
                    <strong>3. Commandes simples :</strong><br/>
                    "echo hello" ‚Üí AST_COMMAND [echo, hello]<br/>
                    "grep h > out" ‚Üí AST_COMMAND [grep, h] + redir(>, out)<br/>
                    "cat file" ‚Üí AST_COMMAND [cat, file]
                </div>
                
                <div class="ast-tree">                    AND
                   /   \
              PIPELINE   COMMAND
              /     \      |
         COMMAND  COMMAND [cat, file]
           |        |
    [echo, hello] [grep, h]
                  redir: > out</div>
            </div>
        </div>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-4">
            <div class="phase-title">üéØ PHASE 4 : GESTION SP√âCIALIS√âE</div>
            
            <div class="step">
                <div class="step-title">1. Architecture Here-Documents</div>
                <div class="step-desc">
                    <span class="code">handle_heredoc(redir)</span> : Impl√©mentation fork/pipe sophistiqu√©e.
                    <strong>Processus parent :</strong> Cr√©e pipe ‚Üí fork ‚Üí attend enfant ‚Üí redirige stdin vers pipe.
                    <strong>Processus enfant :</strong> Lit lignes avec readline ‚Üí compare au d√©limiteur ‚Üí √©crit dans pipe.
                    <strong>Gestion signaux :</strong> SIGINT dans l'enfant ‚Üí fermeture propre + statut d'interruption.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Algorithme de lecture Here-Doc</div>
                <div class="step-desc">
                    <span class="code">heredoc_child_process(pipe_fd, delimiter)</span> :
                    <strong>Boucle infinie :</strong> line = readline("> ") ‚Üí Si NULL (EOF) break ‚Üí Si √©gal d√©limiteur break.
                    <strong>√âcriture :</strong> write(pipe_fd[1], line + "\n") pour chaque ligne.
                    <strong>Interruption :</strong> <span class="code">g_signal_status</span> v√©rifi√© √† chaque it√©ration.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Validation et nettoyage des guillemets</div>
                <div class="step-desc">
                    <span class="code">check_quotes(line)</span> : Automate √† √©tats finis pour validation.
                    <strong>√âtats :</strong> single_quote=0/1, double_quote=0/1. Guillemets s'excluent mutuellement.
                    <span class="code">remove_quotes(str)</span> : Calcul longueur ‚Üí allocation ‚Üí copie s√©lective.
                    <strong>Algorithme :</strong> Deux passes pour optimiser l'allocation m√©moire.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">4. Utilitaires m√©moire et cha√Ænage</div>
                <div class="step-desc">
                    <span class="code">join_and_free(s1, s2)</span> : Pattern RAII pour √©viter les fuites.
                    <strong>S√©curit√© :</strong> G√®re s1 ou s2 NULL ‚Üí strjoin ‚Üí free sources automatiquement.
                    <span class="code">advance_token(tokens)</span> : Avance pointeur dans liste cha√Æn√©e + retourne nouveau.
                    <strong>Robustesse :</strong> V√©rifie tokens != NULL avant d√©r√©f√©rencement.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">5. Gestion avanc√©e de la m√©moire</div>
                <div class="step-desc">
                    <strong>Lib√©ration cascad√©e :</strong> <span class="code">free_ast()</span> r√©cursive sur left/right.
                    <strong>Nettoyage tokens :</strong> <span class="code">free_tokens()</span> parcourt liste cha√Æn√©e.
                    <strong>Gestion erreurs :</strong> En cas d'√©chec allocation ‚Üí lib√©ration de toutes les structures cr√©√©es.
                    <strong>Split arrays :</strong> <span class="code">ft_free_split()</span> pour tableaux dynamiques.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">6. Structures de donn√©es finales</div>
                <div class="step-desc">
                    <strong>AST Node :</strong> type + argv + left/right + redirs (structure auto-descriptive).
                    <strong>Redirections :</strong> Liste cha√Æn√©e avec type + filename + next.
                    <strong>Tokens :</strong> Liste cha√Æn√©e avec type + value + next.
                    <strong>Coh√©rence :</strong> Toutes les structures suivent le m√™me pattern de cha√Ænage.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">7. Cas d'usage sp√©ciaux</div>
                <div class="step-desc">
                    <strong>Commande "clear" :</strong> <span class="code">ft_clear()</span> hardcod√© dans <span class="code">parse()</span> ‚Üí write("\033[H\033[2J").
                    <strong>Redirections seules :</strong> "> file" sans commande ‚Üí argv vide mais redirection conserv√©e.
                    <strong>Variables vides :</strong> $NONEXISTENT ‚Üí cha√Æne vide, pas d'erreur.
                    <strong>Expansion nulle :</strong> Token devient vide ‚Üí supprim√© si pas entre guillemets.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">Exemple Here-Document complet :</div>
                <div style="margin: 15px 0; font-family: monospace; background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 8px;">
<strong>Input:</strong> cat << EOF<br/>
<strong>Parsing:</strong> TOKEN_HEREDOC detect√© ‚Üí parse_redir() ‚Üí handle_heredoc()<br/><br/>

<strong>Fork & Pipe:</strong><br/>
‚îú‚îÄ Parent: pipe(fd) ‚Üí fork() ‚Üí waitpid() ‚Üí dup2(fd[0], STDIN)<br/>
‚îî‚îÄ Child: signal(SIGINT, handler) ‚Üí readline("> ") loop<br/><br/>

<strong>Lecture interactive:</strong><br/>
> premi√®re ligne<br/>
> deuxi√®me ligne  <br/>
> EOF<br/><br/>

<strong>R√©sultat:</strong> stdin contient "premi√®re ligne\ndeuxi√®me ligne\n"
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">AST Final avec toutes les optimisations :</div>
                <div class="ast-tree">Exemple complexe: echo "$USER:$PWD" | grep -v root > /tmp/out 2>&1 && ls -la

                           AND
                         /     \
                   PIPELINE      COMMAND  
                   /      \        |
               COMMAND   COMMAND  [ls, -la]
                 |         |
          [echo, john:/home] [grep, -v, root]
                            redirs: > /tmp/out
                                   2>&1 (si impl√©ment√©)

<strong>Optimisations appliqu√©es:</strong>
‚Ä¢ Expansion: $USER ‚Üí john, $PWD ‚Üí /home  
‚Ä¢ Quotes: "$USER:$PWD" ‚Üí john:/home (pas de split car guillemets doubles)
‚Ä¢ Redirections: Parsing et attachement aux bonnes commandes
‚Ä¢ M√©moire: Lib√©ration automatique en cas d'erreur
‚Ä¢ Associativit√©: Respect√©e pour tous les op√©rateurs</div>
            </div>
        </div>
        
        
        <div class="files-section">
            <div class="files-title">üî¨ ANALYSE TECHNIQUE APPROFONDIE</div>
            
            <div class="file-group">
                <div class="file-group-title">üß† Complexit√© algorithmique :</div>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin: 10px 0;">
                    <strong>Lexer :</strong> O(n) - Parcours lin√©aire de la cha√Æne d'entr√©e<br/>
                    <strong>Expander :</strong> O(n√óm) - n=longueur tokens, m=longueur moyenne apr√®s expansion<br/>
                    <strong>Parser :</strong> O(n) - Parcours unique des tokens avec backtracking limit√©<br/>
                    <strong>M√©moire :</strong> O(n) - Proportionnelle √† la taille de l'entr√©e
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">‚ö° Optimisations impl√©ment√©es :</div>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin: 10px 0;">
                    <strong>‚Ä¢ Allocation intelligente :</strong> <code>get_unquoted_length()</code> calcule la taille exacte avant malloc<br/>
                    <strong>‚Ä¢ Parsing en une passe :</strong> √âvite le reparsing en sauvegardant la position de d√©part<br/>
                    <strong>‚Ä¢ R√©utilisation m√©moire :</strong> <code>join_and_free()</code> lib√®re automatiquement les sources<br/>
                    <strong>‚Ä¢ Early exit :</strong> Validation des guillemets avant parsing complet<br/>
                    <strong>‚Ä¢ Cache des variables :</strong> <code>get_env_value()</code> √©vite les lookups r√©p√©t√©s
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üõ°Ô∏è Gestion robuste des erreurs :</div>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin: 10px 0;">
                    <strong>‚Ä¢ √âchec allocation :</strong> Lib√©ration cascad√©e de toutes les structures<br/>
                    <strong>‚Ä¢ Guillemets non ferm√©s :</strong> Parsing continue, erreur report√©e<br/>
                    <strong>‚Ä¢ Variables inexistantes :</strong> Remplac√©es par cha√Æne vide<br/>
                    <strong>‚Ä¢ Redirections invalides :</strong> D√©tection et cleanup automatique<br/>
                    <strong>‚Ä¢ Signaux :</strong> Interruption propre des here-documents
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üéØ Patterns de conception utilis√©s :</div>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin: 10px 0;">
                    <strong>‚Ä¢ Visitor Pattern :</strong> Parcours r√©cursif de l'AST pour l'ex√©cution<br/>
                    <strong>‚Ä¢ Chain of Responsibility :</strong> expand_variable() ‚Üí expand_special ‚Üí expand_regular<br/>
                    <strong>‚Ä¢ Factory Pattern :</strong> create_token(), new_ast_node() pour la cr√©ation d'objets<br/>
                    <strong>‚Ä¢ RAII (Resource Acquisition) :</strong> join_and_free() pour la gestion m√©moire<br/>
                    <strong>‚Ä¢ State Machine :</strong> check_quotes() utilise un automate √† √©tats finis
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üîç D√©tails d'impl√©mentation critiques :</div>
                <div style="padding: 15px; background: #f8f9fa; border-radius: 8px; margin: 10px 0;">
                    <strong>‚Ä¢ Pr√©servation des guillemets :</strong> Maintenus pendant le lexing pour le contexte d'expansion<br/>
                    <strong>‚Ä¢ Double parsing des commandes :</strong> 1) redirections 2) arguments - √©vite les conflits<br/>
                    <strong>‚Ä¢ Gestion des tokens vides :</strong> Filtr√©s dans split_expanded_token() si longueur = 0<br/>
                    <strong>‚Ä¢ Associativit√© :</strong> R√©cursion droite pour associativit√© gauche (contre-intuitif mais correct)<br/>
                    <strong>‚Ä¢ Here-doc signaux :</strong> g_signal_status global pour communication inter-processus
                </div>
            </div>
        </div>
        
        <div class="files-section">
            <div class="files-title">üìÅ ARCHITECTURE MODULAIRE D√âTAILL√âE</div>
            
            <div class="file-group">
                <div class="file-group-title">üî§ Module Lexer :</div>
                <div class="file-list">
                    <span class="file" title="Point d'entr√©e, tokenisation principale">lexer.c</span>
                    <span class="file" title="Extraction mots/op√©rateurs, cr√©ation tokens">lexer_utils.c</span>
                </div>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    <strong>Responsabilit√©s :</strong> D√©coupage cha√Æne ‚Üí tokens typ√©s, gestion guillemets de base, d√©tection op√©rateurs
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üîÑ Module Expansion :</div>
                <div class="file-list">
                    <span class="file" title="Expansion variables, gestion contextes">expander.c</span>
                    <span class="file" title="Split tokens, cr√©ation listes">expander_utils.c</span>
                    <span class="file" title="Expansion segments, normalisation">expander_utils2.c</span>
                    <span class="file" title="Expansion segments sp√©ciaux, guillemets">clear_utils.c</span>
                    <span class="file" title="Variables r√©guli√®res, remplacement tokens">clear_utils2.c</span>
                </div>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    <strong>Responsabilit√©s :</strong> Expansion variables, gestion contextes guillemets, s√©paration tokens, nettoyage
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üå≥ Module Parser :</div>
                <div class="file-list">
                    <span class="file" title="Parsing principal, collecte arguments">parser.c</span>
                    <span class="file" title="Commandes simples, pipelines">parser2.c</span>
                    <span class="file" title="Cr√©ation tokens, extraction mots">parser_utils.c</span>
                    <span class="file" title="Redirections, n≈ìuds AST">parser_utils2.c</span>
                </div>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    <strong>Responsabilit√©s :</strong> Construction AST, gestion priorit√©s, parsing r√©cursif, redirections
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">üõ†Ô∏è Modules Utilitaires :</div>
                <div class="file-list">
                    <span class="file" title="Validation/suppression guillemets">quotes.c</span>
                    <span class="file" title="Here-documents fork/pipe">heredoc.c</span>
                    <span class="file" title="Tests tokens, pipelines">utils2.c</span>
                    <span class="file" title="Jointure cha√Ænes, helpers">utils3.c</span>
                </div>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    <strong>Responsabilit√©s :</strong> Fonctions support, gestion m√©moire, validations, here-docs
                </div>
            </div>
        </div>
        
        <div class="files-section">
            <div class="files-title">üöÄ COMPARAISON AVEC BASH/ZSH</div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                <div class="file-group">
                    <div class="file-group-title" style="color: #27ae60;">‚úÖ Fonctionnalit√©s impl√©ment√©es :</div>
                    <div style="padding: 15px; background: rgba(39, 174, 96, 0.1); border-radius: 8px;">
                        <strong>‚Ä¢ Expansion variables</strong> ($VAR, $?, $)<br/>
                        <strong>‚Ä¢ Guillemets</strong> (simples/doubles)<br/>
                        <strong>‚Ä¢ Redirections</strong> (<, >, >>, <<)<br/>
                        <strong>‚Ä¢ Pipelines</strong> (|)<br/>
                        <strong>‚Ä¢ Op√©rateurs logiques</strong> (&&, ||)<br/>
                        <strong>‚Ä¢ Here-documents</strong> (<<)<br/>
                        <strong>‚Ä¢ Priorit√© op√©rateurs</strong><br/>
                        <strong>‚Ä¢ Gestion signaux</strong> (SIGINT)
                    </div>
                </div>
                
                <div class="file-group">
                    <div class="file-group-title" style="color: #e74c3c;">‚ùå Limitations par rapport √† Bash :</div>
                    <div style="padding: 15px; background: rgba(231, 76, 60, 0.1); border-radius: 8px;">
                        <strong>‚Ä¢ Pas de globbing</strong> (*.txt, ?)<br/>
                        <strong>‚Ä¢ Pas de substitution</strong> ($(cmd), `cmd`)<br/>
                        <strong>‚Ä¢ Pas d'arithm√©tique</strong> ($((2+2)))<br/>
                        <strong>‚Ä¢ Pas de arrays</strong> (VAR[0])<br/>
                        <strong>‚Ä¢ Pas de redirections fd</strong> (2>&1)<br/>
                        <strong>‚Ä¢ Pas de background</strong> (&)<br/>
                        <strong>‚Ä¢ Pas de job control</strong><br/>
                        <strong>‚Ä¢ Pas d'historique</strong>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="files-section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <div class="files-title" style="color: white;">üéñÔ∏è BILAN TECHNIQUE</div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="margin-top: 0;">üéØ Points Forts</h4>
                    <strong>‚Ä¢ Architecture modulaire</strong> bien s√©par√©e<br/>
                    <strong>‚Ä¢ Gestion m√©moire</strong> rigoureuse<br/>
                    <strong>‚Ä¢ Parsing robuste</strong> avec r√©cup√©ration d'erreurs<br/>
                    <strong>‚Ä¢ Respect des standards</strong> Unix/POSIX<br/>
                    <strong>‚Ä¢ Code maintenable</strong> et extensible
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="margin-top: 0;">‚ö° Performance</h4>
                    <strong>‚Ä¢ Complexit√© lin√©aire</strong> O(n)<br/>
                    <strong>‚Ä¢ Allocation optimis√©e</strong> (pr√©-calcul tailles)<br/>
                    <strong>‚Ä¢ Parsing en une passe</strong><br/>
                    <strong>‚Ä¢ Pas de backtracking</strong> co√ªteux<br/>
                    <strong>‚Ä¢ Lib√©ration automatique</strong> m√©moire
                </div>
                
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px;">
                    <h4 style="margin-top: 0;">üõ°Ô∏è Robustesse</h4>
                    <strong>‚Ä¢ Validation entr√©es</strong> compl√®te<br/>
                    <strong>‚Ä¢ Gestion erreurs</strong> systematique<br/>
                    <strong>‚Ä¢ Cleanup automatique</strong> en cas d'√©chec<br/>
                    <strong>‚Ä¢ Protection overflow</strong> m√©moire<br/>
                    <strong>‚Ä¢ Signaux g√©r√©s</strong> proprement
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 10px;">
                <h3 style="margin-top: 0;">üèÜ CONCLUSION</h3>
                <p style="font-size: 1.1em; line-height: 1.6;">
                    Ce minishell impl√©mente un <strong>parsing professionnel</strong> avec une architecture solide. 
                    La s√©paration lexer/expander/parser suit les <strong>meilleures pratiques</strong> des compilateurs modernes.
                    Le code est <strong>production-ready</strong> pour un sous-ensemble de fonctionnalit√©s shell.
                </p>
            </div>
        </div>
    </div>
</body>
</html>