<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flux de Parsing Minishell</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        .title {
            text-align: center;
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .phase {
            margin: 30px 0;
            padding: 25px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .phase::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            background: var(--phase-bg);
            z-index: 1;
        }
        
        .phase > * {
            position: relative;
            z-index: 2;
        }
        
        .phase-1 { 
            --phase-bg: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border-left: 5px solid #ff6b6b;
            background: rgba(255, 107, 107, 0.05);
        }
        .phase-2 { 
            --phase-bg: linear-gradient(135deg, #4ecdc4, #44a08d);
            border-left: 5px solid #4ecdc4;
            background: rgba(78, 205, 196, 0.05);
        }
        .phase-3 { 
            --phase-bg: linear-gradient(135deg, #45b7d1, #96c93d);
            border-left: 5px solid #45b7d1;
            background: rgba(69, 183, 209, 0.05);
        }
        .phase-4 { 
            --phase-bg: linear-gradient(135deg, #f093fb, #f5576c);
            border-left: 5px solid #f093fb;
            background: rgba(240, 147, 251, 0.05);
        }
        
        .phase-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .step {
            background: white;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid #3498db;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .step:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        
        .step-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .step-desc {
            color: #555;
            line-height: 1.6;
        }
        
        .code {
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
            font-weight: bold;
        }
        
        .arrow {
            text-align: center;
            font-size: 2em;
            color: #7f8c8d;
            margin: 15px 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .example {
            background: rgba(52, 152, 219, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #3498db;
        }
        
        .example-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .tokens {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .token {
            background: #3498db;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(52, 152, 219, 0.3);
        }
        
        .ast-tree {
            font-family: 'Courier New', monospace;
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            white-space: pre;
            line-height: 1.6;
        }
        
        .files-section {
            background: rgba(149, 165, 166, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }
        
        .files-title {
            font-size: 1.5em;
            color: #2c3e50;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .file-group {
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .file-group-title {
            font-weight: bold;
            color: #8e44ad;
            margin-bottom: 8px;
        }
        
        .file-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .file {
            background: #9b59b6;
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.85em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üîç Flux de Parsing du Minishell</h1>
        
        <div class="example">
            <div class="example-title">üìù Exemple d'entr√©e :</div>
            <code>echo "$USER world" | grep hello > output.txt && cat file</code>
        </div>
        
        <div class="phase phase-1">
            <div class="phase-title">üî§ PHASE 1 : ANALYSE LEXICALE (Lexer)</div>
            
            <div class="step">
                <div class="step-title">1. Tokenisation</div>
                <div class="step-desc">
                    La fonction <span class="code">lexer()</span> parcourt la cha√Æne caract√®re par caract√®re et identifie les tokens.
                    Elle utilise <span class="code">skip_whitespace()</span> pour ignorer les espaces.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. D√©tection des op√©rateurs</div>
                <div class="step-desc">
                    <span class="code">is_operator()</span> identifie |, <, >, &. 
                    <span class="code">get_operator_type()</span> d√©termine le type exact (||, <<, >>, &&).
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Extraction des mots avec guillemets</div>
                <div class="step-desc">
                    <span class="code">extract_word_with_quotes()</span> g√®re les guillemets simples et doubles,
                    pr√©servant le contenu entre guillemets comme un seul token.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">R√©sultat apr√®s lexing :</div>
                <div class="tokens">
                    <span class="token">echo</span>
                    <span class="token">"$USER world"</span>
                    <span class="token">|</span>
                    <span class="token">grep</span>
                    <span class="token">hello</span>
                    <span class="token">></span>
                    <span class="token">output.txt</span>
                    <span class="token">&&</span>
                    <span class="token">cat</span>
                    <span class="token">file</span>
                </div>
            </div>
        </div>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-2">
            <div class="phase-title">üîÑ PHASE 2 : EXPANSION (Expander)</div>
            
            <div class="step">
                <div class="step-title">1. D√©tection des variables</div>
                <div class="step-desc">
                    <span class="code">expand_variable()</span> identifie les variables ($USER, $?, $$) et les remplace par leurs valeurs.
                    G√®re les variables sp√©ciales et les variables d'environnement.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Gestion des contextes de guillemets</div>
                <div class="step-desc">
                    Les guillemets simples emp√™chent l'expansion. Les guillemets doubles permettent l'expansion.
                    <span class="code">expand_in_double_quotes()</span> vs <span class="code">handle_single_quote()</span>.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. S√©paration des tokens</div>
                <div class="step-desc">
                    Si une expansion contient des espaces et n'√©tait pas entre guillemets,
                    <span class="code">split_expanded_token()</span> divise le token en plusieurs.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">4. Suppression des guillemets</div>
                <div class="step-desc">
                    <span class="code">remove_quotes()</span> enl√®ve les guillemets externes apr√®s expansion.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">R√©sultat apr√®s expansion (si $USER = "john") :</div>
                <div class="tokens">
                    <span class="token">echo</span>
                    <span class="token">john world</span>
                    <span class="token">|</span>
                    <span class="token">grep</span>
                    <span class="token">hello</span>
                    <span class="token">></span>
                    <span class="token">output.txt</span>
                    <span class="token">&&</span>
                    <span class="token">cat</span>
                    <span class="token">file</span>
                </div>
            </div>
        </div>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-3">
            <div class="phase-title">üå≥ PHASE 3 : ANALYSE SYNTAXIQUE (Parser)</div>
            
            <div class="step">
                <div class="step-title">1. Parsing r√©cursif descendant</div>
                <div class="step-desc">
                    <span class="code">parse_and_or()</span> ‚Üí <span class="code">parse_pipeline()</span> ‚Üí <span class="code">parse_command()</span>
                    Respecte la priorit√© des op√©rateurs (AND/OR < PIPE).
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">2. Construction de l'AST</div>
                <div class="step-desc">
                    Chaque fonction de parsing cr√©e des n≈ìuds AST avec <span class="code">new_ast_node()</span>.
                    Les n≈ìuds contiennent le type, les enfants gauche/droit, les arguments et redirections.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">3. Gestion des redirections</div>
                <div class="step-desc">
                    <span class="code">parse_redirections()</span> identifie <, >, >>, << et cr√©e des structures <span class="code">t_redir</span>
                    attach√©es aux commandes correspondantes.
                </div>
            </div>
            
            <div class="step">
                <div class="step-title">4. Collecte des arguments</div>
                <div class="step-desc">
                    <span class="code">gather_all_words()</span> rassemble tous les mots d'une commande en tableau argv.
                </div>
            </div>
        </div>
        
        <div class="arrow">‚¨áÔ∏è</div>
        
        <div class="phase phase-4">
            <div class="phase-title">üéØ PHASE 4 : AST FINAL ET STRUCTURES</div>
            
            <div class="step">
                <div class="step-title">Structure de l'AST r√©sultant</div>
                <div class="step-desc">
                    L'arbre syntaxique abstrait respecte la priorit√© des op√©rateurs et permet une ex√©cution r√©cursive.
                </div>
            </div>
            
            <div class="example">
                <div class="example-title">AST Final :</div>
                <div class="ast-tree">                    AND
                   /   \
              PIPELINE   COMMAND
              /     \      |
         COMMAND  COMMAND [cat, file]
           |        |
    [echo, john,  [grep, hello]
     world]       redir: > output.txt</div>
            </div>
            
            <div class="step">
                <div class="step-title">Gestion des Here-documents</div>
                <div class="step-desc">
                    <span class="code">handle_heredoc()</span> cr√©e un processus enfant qui lit jusqu'au d√©limiteur
                    et communique via pipe avec le parent.
                </div>
            </div>
        </div>
        
        <div class="files-section">
            <div class="files-title">üìÅ Organisation des fichiers</div>
            
            <div class="file-group">
                <div class="file-group-title">Lexer :</div>
                <div class="file-list">
                    <span class="file">lexer.c</span>
                    <span class="file">lexer_utils.c</span>
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">Expansion :</div>
                <div class="file-list">
                    <span class="file">expander.c</span>
                    <span class="file">expander_utils.c</span>
                    <span class="file">expander_utils2.c</span>
                    <span class="file">clear_utils.c</span>
                    <span class="file">clear_utils2.c</span>
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">Parser :</div>
                <div class="file-list">
                    <span class="file">parser.c</span>
                    <span class="file">parser2.c</span>
                    <span class="file">parser_utils.c</span>
                    <span class="file">parser_utils2.c</span>
                </div>
            </div>
            
            <div class="file-group">
                <div class="file-group-title">Utilitaires :</div>
                <div class="file-list">
                    <span class="file">quotes.c</span>
                    <span class="file">heredoc.c</span>
                    <span class="file">utils2.c</span>
                    <span class="file">utils3.c</span>
                </div>
            </div>
        </div>
    </div>
</body>
</html>